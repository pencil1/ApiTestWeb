"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var echarts=_interopDefault(require("echarts/lib/echarts")),constants=require('./constants'),utils=require('./utils');require("echarts/lib/chart/map");var Core=_interopDefault(require('./core')),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e};function getTooltip(e,t,o,r,i,n){return{formatter:function(a){var s=[];return s.push(a.name+"<br>"),r.forEach(function(r,c){var l=null!=n[r]?n[r]:r;s.push(constants.itemPoint(i[c])+" "+l+" : "),o[a.name]?s.push(utils.getFormated(o[a.name][r],e[r],t)):s.push("-"),s.push("<br>")}),s.join(" ")}}}function getSeries(e){var t=e.position,o=e.selectData,r=e.dimension,i=e.metrics,n=e.rows,a=e.label,s=e.itemStyle,c=e.selectedMode,l=e.roam,p=e.center,u=e.aspectScale,d=e.boundingCoords,m=e.zoom,f=e.labelMap,g=e.scaleLimit,b=e.mapGrid,h=[],v={type:"map",mapType:t};return i.forEach(function(e){var t=_extends({name:null!=f[e]?f[e]:e,data:[],selectedMode:c,roam:l,center:p,aspectScale:u,boundingCoords:d,zoom:m,scaleLimit:g},v);b&&Object.keys(b).forEach(function(e){t[e]=b[e]}),setGeoLabel(s,t,"itemStyle"),setGeoLabel(a,t,"label"),n.forEach(function(i){t.data.push({name:i[r],value:i[e],selected:o})}),h.push(t)}),h}function setGeoLabel(e,t,o){"object"===(void 0===e?"undefined":_typeof(e))?t[o]=e:e&&(t[o]={normal:{show:!0},emphasis:{show:!0}})}function getLegendMap(e){var t=e.metrics,o=e.legendName,r=e.labelMap;return o||r?{data:r?t.map(function(e){return null==r[e]?e:r[e]}):t,formatter:function(e){return null!=o[e]?o[e]:e}}:{data:t}}function registerMap(e,t){var o=e._once,r=e.registerSign,i=e.beforeRegisterMap,n=e.beforeRegisterMapOnce,a=e.registerSignOnce,s=e.position,c=e.specialAreas;o[r]||(i&&(t=i(t)),n&&!o[a]&&(o[a]=!0,t=n(t)),o[r]=!0,echarts.registerMap(s,t,c))}var map$1=function(e,t,o,r){var i=o.position,n=void 0===i?"china":i,a=o.selectData,s=void 0!==a&&a,c=o.selectedMode,l=o.label,p=void 0===l||l,u=o.dataType,d=void 0===u?{}:u,m=o.digit,f=void 0===m?2:m,g=o.dimension,b=void 0===g?e[0]:g,h=o.roam,v=o.center,y=o.aspectScale,M=o.boundingCoords,S=o.zoom,_=o.scaleLimit,O=o.legendName,L=void 0===O?{}:O,R=o.labelMap,E=void 0===R?{}:R,x=o.mapGrid,G=o.itemStyle,j=o.positionJsonLink,C=o.beforeRegisterMap,D=o.beforeRegisterMapOnce,P=o.mapURLProfix,T=void 0===P?"https://unpkg.com/echarts@3.6.2/map/json/":P,q=o.specialAreas,w=void 0===q?{}:q,A=o.mapOrigin,N=e.slice();o.metrics?N=o.metrics:N.splice(e.indexOf(b),1);var k=r.tooltipVisible,z=r.legendVisible,J=r.color,V=r._once,I={};t.forEach(function(e){I[e[b]]=e});var U=k&&getTooltip(d,f,I,N,J,E),$=z&&getLegendMap({metrics:N,legendName:L,labelMap:E}),F=getSeries({position:n,selectData:s,label:p,itemStyle:G,dimension:b,metrics:N,rows:t,selectedMode:c,roam:h,center:v,aspectScale:y,boundingCoords:M,zoom:S,labelMap:E,scaleLimit:_,mapGrid:x}),H={_once:V,beforeRegisterMap:C,beforeRegisterMapOnce:D,registerSign:"MAP_REGISTER_"+n,registerSignOnce:"ONCE_MAP_REGISTER_"+n,position:n,specialAreas:w};return A?(registerMap(H,A),{series:F,tooltip:U,legend:$}):utils.getMapJSON({position:n,positionJsonLink:j,beforeRegisterMapOnce:D,mapURLProfix:T}).then(function(e){return registerMap(H,e),{series:F,tooltip:U,legend:$}})},index=_extends({},Core,{name:"VeMap",data:function(){return this.chartHandler=map$1,{}}});module.exports=index;
